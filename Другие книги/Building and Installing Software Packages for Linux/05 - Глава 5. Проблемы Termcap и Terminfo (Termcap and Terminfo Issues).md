Согласно своей `man`-странице, **«terminfo** — это база данных, описывающая терминалы, используемая программами с ориентированным на экран выводом...». Она определяет общий набор управляющих последовательностей (escape-кодов), используемых для отображения текста на терминалах, и делает возможной поддержку различного терминального оборудования без необходимости в специальных драйверах. Библиотеки `terminfo` располагаются в `/usr/share/terminfo` в современных дистрибутивах Linux.

База данных `terminfo` в значительной степени вытеснила более старые `termcap` и полностью устаревшие `termlib`. Обычно это не вызывает проблем при установке программ, за исключением случаев работы с пакетом, который требует `termcap`.

Большинство дистрибутивов Linux теперь используют `terminfo`, но по-прежнему сохраняют старые библиотеки `termcap` для совместимости с устаревшими приложениями (см. `/etc/termcap`). Иногда существует специальный пакет совместимости, который необходимо установить для облегчения использования бинарных файлов, скомпилированных с `termcap`. Очень редко может потребоваться закомментировать директиву `#define termcap` в исходном файле. Для получения точной информации по этому вопросу проверьте соответствующую документацию вашего конкретного дистрибутива.

---
[[[Навигация по книге «Building and Installing Software Packages for Linux»]]

### Зачем вам это нужно? Развёрнутые пояснения

Эта глава затрагивает специфическую, но важную тему взаимодействия программ с терминалом. Хотя она короткая, понимание этих концепций критически важно для сборки LFS и последующей работы в текстовом режиме.

**1. Исторический контекст: эволюция управления терминалом.**

- **Termcap (Terminal Capability Database):** Старая система, в которой возможности каждого терминала описывались в одном большом файле (`/etc/termcap`). Программа искала нужный терминнал в этом файле и загружала его параметры. Неэффективно, так как нужно было читать весь файл.

- **Terminfo (Terminal Information):** Более новая и эффективная система. Для каждого типа терминала создается отдельный скомпилированный файл в каталоге `/usr/share/terminfo/` (например, `/usr/share/terminfo/x/xterm`). Программа загружает только нужный файл. Это стандарт в современных системах.

- **Termlib:** Устаревшая библиотека, о которой можно забыть.

**2. Почему это важно для сборки ПО и LFS?**

- **Совместимость:** Некоторые старые программы ожидают наличия библиотеки `libtermcap`. Если вы собираете такую программу в LFS, вам нужно либо:

    1. Убедиться, что библиотека `termcap` установлена (в LFS её нет по умолчанию).

    2. Либо модифицировать программу для использования `terminfo` (что часто проще).

- **Зависимости:** Во время сборки LFS вы будете работать в `chroot`-окружении, где нет графического интерфейса. Все действия происходят в виртуальном терминале. Корректная работа таких базовых утилит, как `nano`, `vim`, `mc` и даже `ls` (с цветным выводом), зависит от правильной настройки терминальной базы данных.

- **Ошибки при сборке:** Автор упоминает, что иногда нужно закомментировать строку `#define termcap` в исходном коде. Это классический пример патча, который может потребоваться применить к некоторым пакетам в LFS, чтобы они компилировались с terminfo вместо устаревшего `termcap`.

**3. Практические следствия для LFS:**

- В книге LFS явно указано, какие пакеты устанавливать для поддержки terminfo. Основной пакет — **Ncurses**. `Ncurses` — это библиотека, которая предоставляет API для создания текстового пользовательского интерфейса и **содержит базу данных terminfo**.

- При сборке LFS вы установите `Ncurses`, и она создаст каталог `/usr/share/terminfo/` с описаниями терминалов. Без этого многие программы не смогут корректно отображать интерфейс.

- Если после сборки LFS у вас не работают цвета в терминале или слетает разметка при запуске текстовых программ, первое, что нужно проверить — корректно ли установлен пакет `Ncurses` и задана ли переменная окружения `TERM` (например, `export TERM=xterm-256color`).

**4. Переменная окружения `TERM`.**

- Это ключевое понятие, которое автор опустил, но оно напрямую связано с `terminfo/termcap`. Переменная `TERM` сообщает программам, какой тип терминала вы используете.

- При работе в LFS (особенно в `chroot`) важно правильно установить эту переменную, чтобы программы знали, какие управляющие последовательности они могут использовать. Обычно устанавливают `TERM=linux` (для виртуальной консоли) или `TERM=xterm` (для эмулятора терминала).

**Практический пример для понимания:**

1. Запустите в своей системе: `echo $TERM`. Вы увидите что-то вроде `xterm-256color`.

2. Посмотрите, какой файл terminfo соответствует вашему терминалу: `ls -la /usr/share/terminfo/x/xterm*`. Вы увидите скомпилированный файл, который описывает, как ваш терминал реагирует на различные escape-коды (например, очистка экрана, перемещение курсора, цвета).

**Как это применяется в LFS:**  
В процессе сборки LFS вы установите `Ncurses`, и она создаст базу данных `terminfo`. Затем, когда вы соберете программу, которая использует `Ncurses` (например, `vim` или `mc`), она будет обращаться к этой базе данных, чтобы понять, как взаимодействовать с вашим терминалом. Если база данных отсутствует или повреждена, эти программы будут вести себя некорректно.

**Итог главы:**  
Хотя глава короткая, она затрагивает важный аспект низкоуровневой работы системы. Понимание различий между `termcap` и `terminfo` и знание того, что `Ncurses` предоставляет современную реализацию terminfo, поможет вам избежать проблем с текстовым интерфейсом в вашей собранной системе LFS. В процессе сборки LFS вы будете уделять внимание установке правильных зависимостей (`Ncurses`), и это гарантирует, что все текстовые программы будут работать корректно.